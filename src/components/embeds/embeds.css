/* ============================================
   Embed Cards
   Styled cards for Twitter/X and Substack embeds
   Matches native embed styling
   ============================================ */

.embed-card {
  display: block;
  /* Embeds replace <p>, so they need paragraph-like rhythm (no extra top margin) */
  margin: 0 0 var(--notes-line-height);
  /* IMPORTANT: keep total height aligned to the notes grid.
     Using half-line padding on top + bottom ensures the card height stays a multiple of
     `--notes-line-height` (since paddingTop + paddingBottom = 1 line). */
  /* Slightly less top padding to remove "dead air" above the title while
     keeping total (top + bottom) padding = 1 line for grid alignment. */
  padding: 10px 18px 20px;
  background: rgba(255, 255, 255, 0.92);
  border: none; /* borders shift layout off the paper line grid */
  border-radius: 14px;
  text-decoration: none !important;
  transition:
    transform 0.2s ease,
    background-color 0.2s ease,
    border-color 0.2s ease,
    box-shadow 0.2s ease;
  box-shadow:
    inset 0 0 0 1px rgba(201, 169, 154, 0.55), /* outline without layout shift */
    0 1px 2px rgba(0, 0, 0, 0.04),
    0 8px 18px rgba(0, 0, 0, 0.04);
}

/* Substack cards can sit a touch higher while preserving grid alignment (top+bottom = 30px). */
.embed-card--substack.embed-card--rich {
  /* Balanced breathing room while keeping top+bottom = 30px */
  padding-top: 10px;
  padding-bottom: 20px;
}

/* Tweet cards need a slightly tighter top edge (while still keeping top+bottom = 1 line). */
.embed-card--tweet {
  /* IMPORTANT: keep (top + bottom) padding = 1 grid line (30px). */
  padding-top: 10px;
  padding-bottom: 20px;
}

/* Tweet header was still measuring too tall (wrapping / inherited line-height).
   Force it to exactly 2 note lines to keep the paper grid alignment. */
.embed-card--tweet .embed-card__header {
  height: calc(var(--notes-line-height) * 2);
  min-height: calc(var(--notes-line-height) * 2);
  overflow: hidden;
}

.embed-card:hover {
  transform: translateY(-1px);
  background: rgba(255, 255, 255, 0.97);
  box-shadow:
    inset 0 0 0 1px rgba(201, 169, 154, 0.75),
    0 3px 10px rgba(0, 0, 0, 0.06),
    0 12px 28px rgba(0, 0, 0, 0.06);
  text-decoration: none !important;
}

.embed-card:active {
  transform: translateY(0);
  background: rgba(255, 255, 255, 0.92);
  box-shadow:
    inset 0 0 0 1px rgba(201, 169, 154, 0.65),
    0 1px 2px rgba(0, 0, 0, 0.04),
    0 6px 14px rgba(0, 0, 0, 0.04);
}

/* Remove any link underlines */
.embed-card,
.embed-card *,
.embed-card:hover,
.embed-card:hover * {
  text-decoration: none !important;
}

/* ============================================
   Header - Logo + Publication Name
   ============================================ */
.embed-card__header {
  display: flex;
  align-items: center;
  gap: 10px;
  /* Keep header as exactly one notes line */
  margin-bottom: 0;
  min-height: var(--notes-line-height);
}

/* Substack header should be visually compact (one line) */
.embed-card--substack.embed-card--rich .embed-card__header {
  height: var(--notes-line-height);
  min-height: var(--notes-line-height);
  /* Don't clip the logo; keep a true single-row header. */
  overflow: visible;
  align-items: center;
}

/* In Notes, surrounding line-height is 30px; force header text to be compact. */
.embed-card--substack.embed-card--rich .embed-card__publication-name {
  line-height: 1.2;
  transform: none;
}

.embed-card--substack.embed-card--rich .embed-card__publication-logo {
  transform: none;
}

/* Simple icon (fallback mode) */
.embed-card__icon {
  width: 16px;
  height: 16px;
  flex-shrink: 0;
  fill: var(--notes-text-muted);
  transition: fill 0.2s ease;
}

/* Platform icon (top-right for tweets) */
.embed-card__platform-icon {
  width: 18px;
  height: 18px;
  flex-shrink: 0;
  fill: var(--notes-text-muted);
  margin-left: auto;
  transition: fill 0.2s ease;
}

/* Profile avatar (Twitter) */
.embed-card__avatar {
  /* Keep header height locked to the notes grid */
  width: 30px;
  height: 30px;
  border-radius: 50%;
  object-fit: cover;
  flex-shrink: 0;
  transition: transform 0.2s ease;
}

.embed-card:hover .embed-card__avatar {
  transform: scale(1.03);
}

/* Publication logo (Substack) */
.embed-card__publication-logo {
  width: 22px;
  height: 22px;
  border-radius: 5px;
  object-fit: cover;
  flex-shrink: 0;
}

/* Author info container (Twitter) */
.embed-card__author-info {
  display: flex;
  flex-direction: column;
  gap: 0;
  min-width: 0;
}

/* Author display name */
.embed-card__author-name {
  font-family: var(--font-notes-body);
  font-size: 14px;
  font-weight: 600;
  color: var(--notes-text-primary);
  line-height: 1.2;
}

/* Author handle (@username) */
.embed-card__author-handle {
  font-family: var(--font-notes-body);
  font-size: 12px;
  color: var(--notes-text-muted);
  line-height: 1.2;
}

/* Simple author text (fallback mode) */
.embed-card__author {
  font-family: var(--font-notes-body);
  font-size: 13px;
  color: var(--notes-text-muted);
  font-weight: 500;
}

/* Publication name (Substack) */
.embed-card__publication-name {
  font-family: var(--font-notes-body);
  font-size: 13px;
  font-weight: 600;
  color: var(--notes-text-secondary);
}

/* ============================================
   Body Content
   ============================================ */
.embed-card__body {
  /* Keep the card content "tight" internally without looking cramped */
  margin-bottom: 0;
}

/* Main content text (tweet text) */
.embed-card__content {
  font-family: var(--font-notes-body);
  /* Inherit the note's grid: 18px font + 30px line height from `.notes-content__text` */
  font-size: inherit;
  line-height: var(--notes-line-height);
  color: var(--notes-text-primary);
  margin: 0;
  display: -webkit-box;
  -webkit-line-clamp: 5;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* Article title (Substack) */
.embed-card__title {
  font-family: var(--font-notes-title);
  font-size: 22px;
  font-weight: 700;
  /* Default: stay on the grid */
  line-height: var(--notes-line-height);
  color: var(--notes-text-primary);
  /* Tight title -> description, like the screenshot */
  margin: 0;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* Substack: remove perceived "gaps" by pinning text to the row edges.
   We use transforms so the layout grid stays perfectly aligned. */
/* Substack spacing:
   You can't see the paper lines behind the card, so we keep the CARD height grid-safe,
   then tighten INTERNAL spacing visually using transforms (no layout impact). */
.embed-card--substack.embed-card--rich .embed-card__title {
  transform: translateY(-4px);
}

/* Never truncate Substack descriptions */
.embed-card--substack.embed-card--rich .embed-card__description {
  display: block;
  overflow: visible;
  transform: translateY(-6px);
  -webkit-line-clamp: unset;
  -webkit-box-orient: unset;
}

.embed-card--substack.embed-card--rich .embed-card__actions {
  transform: translateY(-10px);
}

/* Article description/subtitle (Substack) */
.embed-card__description {
  font-family: var(--font-notes-body);
  /* Keep description aligned to the paper lines */
  font-size: inherit;
  line-height: var(--notes-line-height);
  color: var(--notes-text-secondary);
  margin: 0;
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* Title styling for fallback mode */
.embed-card__content--title {
  font-weight: 600;
  font-size: 15px;
  -webkit-line-clamp: 2;
}

/* ============================================
   Actions + Meta (Substack-like)
   ============================================ */
.embed-card__actions {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  /* Snap actions to the grid */
  margin-top: 0;
  min-height: var(--notes-line-height);
  /* Make "Read more" and "By ..." the same size */
  font-size: 12px;
}

.embed-card__byline {
  font-family: var(--font-notes-body);
  font-size: inherit;
  line-height: var(--notes-line-height);
  color: var(--notes-text-muted);
  white-space: nowrap;
}

.embed-card__meta {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  /* Snap meta to the grid */
  margin-top: 0;
  font-family: var(--font-notes-body);
  font-size: inherit;
  line-height: var(--notes-line-height);
  color: var(--notes-text-muted);
}

.embed-card__meta--tweet {
  /* IMPORTANT: the date row must be exactly 1 grid line tall so the card ends
     on a perfect paper line. Avoid margins/padding here (they change layout). */
  margin-top: 0;
  height: var(--notes-line-height);
  display: flex;
  align-items: flex-end; /* more top space, less bottom space */
  flex-wrap: nowrap;
  font-size: 12px;
}

.embed-card__meta-item {
  line-height: 1.2;
}

/* Slight visual nudge down without affecting layout */
.embed-card__meta--tweet .embed-card__meta-item {
  line-height: 1;
  transform: translateY(2px);
}

/* ============================================
   Footer - Date, CTA, Author
   ============================================ */
.embed-card__footer {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-top: 12px;
  gap: 12px;
}

/* Date text (Twitter) */
.embed-card__date {
  font-family: var(--font-notes-body);
  font-size: 13px;
  color: var(--notes-text-muted);
}

/* Simple CTA text */
.embed-card__cta {
  font-family: var(--font-notes-body);
  font-size: 13px;
  color: #6B5B4F;
  font-weight: 500;
  transition: color 0.2s ease;
}

.embed-card:hover .embed-card__cta {
  color: #4a3f37;
}

/* Button-style CTA (Substack) */
.embed-card__cta-button {
  font-family: var(--font-notes-body);
  /* Smaller, more proportional button */
  font-size: inherit;
  font-weight: 600;
  color: var(--notes-text-secondary);
  background: rgba(255, 255, 255, 0.86);
  border: none; /* keep grid alignment; use inset shadow instead */
  padding: 0 12px;
  height: 24px;
  line-height: 24px;
  border-radius: 12px;
  box-shadow:
    inset 0 0 0 1px rgba(201, 169, 154, 0.55),
    0 1px 0 rgba(255, 255, 255, 0.6),
    0 1px 2px rgba(0, 0, 0, 0.04);
  transition: background-color 0.2s ease, box-shadow 0.2s ease, color 0.2s ease;
}

.embed-card:hover .embed-card__cta-button {
  background: rgba(255, 255, 255, 0.98);
  box-shadow:
    inset 0 0 0 1px rgba(201, 169, 154, 0.55),
    0 2px 0 rgba(255, 255, 255, 0.7),
    0 3px 10px rgba(0, 0, 0, 0.06);
  color: var(--notes-text-primary);
}

/* Author in footer (Substack) */
.embed-card__footer .embed-card__author-name {
  font-size: 11px;
  font-weight: 500;
  color: var(--notes-text-muted);
}

/* ============================================
   Platform-specific styling
   ============================================ */

/* Twitter/X */
.embed-card--tweet .embed-card__icon {
  fill: #536471;
}

.embed-card--tweet:hover .embed-card__icon,
.embed-card--tweet:hover .embed-card__platform-icon {
  fill: #1d9bf0;
}

/* Substack */
.embed-card--substack .embed-card__icon {
  fill: #536471;
}

.embed-card--substack:hover .embed-card__icon {
  fill: #ff6719;
}

/* Rich Substack card has separator after header */
.embed-card--rich .embed-card__header {
  position: relative;
  padding-bottom: 0;
  margin-bottom: 0;
}

/* Draw a separator without affecting layout metrics */
.embed-card--rich .embed-card__header::after {
  content: '';
  position: absolute;
  left: 0;
  right: 0;
  bottom: -1px;
  height: 1px;
  background: rgba(201, 169, 154, 0.35);
  pointer-events: none;
}
